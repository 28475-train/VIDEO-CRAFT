<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ADMIN | KIZUNA VIDEO</title>
    <style>
        :root {
            --bg: #f2f2f7;
            --card: #ffffff;
            --text: #1d1d1f;
            --accent: #0071e3;
            --border: #d2d2d7;
        }
        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #000000;
                --card: #1c1c1e;
                --text: #f5f5f7;
                --border: #38383a;
            }
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: var(--bg); color: var(--text); font-family: -apple-system, sans-serif; padding: 20px; }
        .card { background: var(--card); border-radius: 20px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        h1 { font-size: 1.2rem; margin-bottom: 20px; text-align: center; }
        label { display: block; font-size: 0.75rem; color: var(--accent); font-weight: 700; margin-bottom: 5px; }
        select, input, textarea { width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 10px; background: var(--bg); color: var(--text); margin-bottom: 15px; font-size: 1rem; }
        .btn-update { width: 100%; padding: 16px; background: var(--accent); color: white; border: none; border-radius: 14px; font-weight: 700; cursor: pointer; }
    </style>
</head>
<body>
    <div class="card">
        <h1>進捗更新システム</h1>
        <label>更新するID</label>
        <input type="text" id="target-id" placeholder="例: video-1234">
        
        <label>現在のステータス</label>
        <select id="new-status">
            <option value="構成案を作成中">構成案を作成中</option>
            <option value="素材を編集中">素材を編集中</option>
            <option value="初稿確認のお願い">初稿確認のお願い</option>
            <option value="修正対応中">修正対応中</option>
            <option value="制作完了・納品">制作完了・納品</option>
        </select>

        <label>進捗率（%）</label>
        <input type="number" id="new-progress" value="0" min="0" max="100">

        <label>メッセージ</label>
        <textarea id="new-message" rows="3" placeholder="依頼者へのメッセージ"></textarea>

        <button class="btn-update" onclick="updateSpreadsheet()">データを更新する</button>
        <p id="result-msg" style="text-align: center; margin-top: 15px; font-size: 0.8rem;"></p>
    </div>

    <script>
        const GAS_URL = "あなたのウェブアプリURL";

        async function updateSpreadsheet() {
            const btn = document.querySelector('.btn-update');
            const msg = document.getElementById('result-msg');
            const data = {
                id: document.getElementById('target-id').value,
                status: document.getElementById('new-status').value,
                progress: document.getElementById('new-progress').value,
                message: document.getElementById('new-message').value,
                action: "update"
            };

            if(!data.id) return alert("IDを入力してください");

            btn.disabled = true;
            msg.innerText = "更新中...";

            try {
                const response = await fetch(GAS_URL, {
                    method: "POST",
                    body: JSON.stringify(data)
                });
                msg.innerText = "更新が完了しました";
                setTimeout(() => { msg.innerText = ""; }, 3000);
            } catch (e) {
                msg.innerText = "エラーが発生しました";
            } finally {
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
